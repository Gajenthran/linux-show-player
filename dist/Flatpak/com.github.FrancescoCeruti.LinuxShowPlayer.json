{
	"app-id": "com.github.FrancescoCeruti.LinuxShowPlayer",
	"runtime": "org.gnome.Platform",
	"runtime-version": "3.28",
	"sdk": "org.gnome.Sdk",
	"command": "linux-show-player",
	"build-options": {
		"no-debuginfo": true
	},
	"finish-args": [
		"--share=network",
		"--socket=x11",
		"--socket=wayland",
		"--socket=pulseaudio",
		"--filesystem=home",
		"--device=all"
	],
	"cleanup-commands": [
		"pip3 uninstall --yes cython || true"
	],
	"rename-appdata-file": "linuxshowplayer.appdata.xml",
    "rename-desktop-file": "linuxshowplayer.desktop",
    "rename-icon": "linuxshowplayer",
	"modules": [
		{
			"name": "cpython",
			"buildsystem": "simple",
			"build-commands": [
				"cp -r bin/ include/ lib/ share/ /app"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://dl.bintray.com/francescoceruti/flatpak-builds/py3.6.5-freedesktop1.6.tar.gz",
					"sha256": "d55bea2a7e62f90df90c2a8069d5efbd7a1bb6698b0293db5947f874eaa243be"
				}
			]
		},
		{
			"name": "upgrade-pip",
			"buildsystem": "simple",
			"build-commands": [
				"python3 setup.py install --prefix=/app"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://files.pythonhosted.org/packages/ae/e8/2340d46ecadb1692a1e455f13f75e596d4eab3d11a57446f08259dee8f02/pip-10.0.1.tar.gz",
					"sha256": "f2bd08e0cd1b06e10218feaf6fef299f473ba706582eb3bd9d52203fdbd7ee68"
				}
			]
		},
		{
			"name": "Jack",
			"buildsystem": "simple",
			"build-commands": [
				"./waf configure --prefix='/app/'",
				"./waf",
				"./waf install"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://github.com/jackaudio/jack2/releases/download/v1.9.12/jack2-1.9.12.tar.gz",
					"sha1": "8ab6329c6a107cdf370c40afac154370b406437d"
				}
			],
			"cleanup": [
				"/bin"
			]
		},
		{
            "name": "gstreamer-plugins-good",
            "config-opts": [
				"--enable-silent-rules",
				"--enable-experimental",
				"--disable-monoscope",
				"--disable-aalib",
				"--enable-cairo",
				"--disable-libcaca",
				"--disable-gtk-doc-html",
				"--with-default-visualizer=autoaudiosink"
			],
            "sources": [
                 {
                     "type": "archive",
                     "url": "http://gstreamer.freedesktop.org/src/gst-plugins-good/gst-plugins-good-1.10.5.tar.xz",
                     "sha256": "be053f6ed716eeb517cec148cec637cdce571c6e04d5c21409e2876fb76c7639"
                 }
            ]
        },
		{
			"name": "RtMidi",
			"config-opts": [
				"--with-jack",
				"--with-alsa"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/thestk/rtmidi.git",
					"tag": "v3.0.0",
					"commit": "88e53b9cfe60719c9ade800795313f3c6026c48c"
				}
			]
		},
		{
			"name": "liblo",
			"config-opts": [
				"--disable-examples",
				"--disable-tools"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/radarsat1/liblo.git",
					"tag": "0.29",
					"commit": "901c6ff1ab269d964e256936a609779f86047ebd"
				}
			]
		},
		{
			"name": "cpp-google-protobuf",
			"config-opts": [
				"--disable-static"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://github.com/google/protobuf/releases/download/v3.1.0/protobuf-cpp-3.1.0.tar.gz",
					"sha1": "b7b7275405ac18784965b02bea7d62f836873564"
				}
			]
		},
		{
			"name": "sip",
			"buildsystem": "simple",
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} sip-4.19.8-cp36-cp36m-manylinux1_x86_64.whl"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/8a/ea/d317ce5696dda4df7c156cd60447cda22833b38106c98250eae1451f03ec/sip-4.19.8-cp36-cp36m-manylinux1_x86_64.whl",
					"sha256": "cf98150a99e43fda7ae22abe655b6f202e491d6291486548daa56cb15a2fcf85"
				}
			],
			"cleanup": [
				"/bin",
				"/include"
			]
		},
		{
			"name": "PyQt5",
			"buildsystem": "simple",
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} PyQt5-5.10.1-5.10.1-cp35.cp36.cp37.cp38-abi3-manylinux1_x86_64.whl"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/e4/15/4e2e49f64884edbab6f833c6fd3add24d7938f2429aec1f2883e645d4d8f/PyQt5-5.10.1-5.10.1-cp35.cp36.cp37.cp38-abi3-manylinux1_x86_64.whl",
					"sha256": "1e652910bd1ffd23a3a48c510ecad23a57a853ed26b782cd54b16658e6f271ac"
				}
			]
		},
		{
			"name": "python-google-protobuf",
			"buildsystem": "simple",
			"build-options": {
				"build-args": [
					"--share=network"
				]
			},
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} protobuf==3.1.0.post1"
			]
		},
		{
			"name": "ola",
			"build-options": {
				"env": {
					"PYTHON": "python3"
				}
			},
			"config-opts": [
				"--disable-unittests",
				"--disable-examples",
				"--disable-osc",
				"--disable-http",
				"--enable-python-libs"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/OpenLightingProject/ola.git",
					"tag": "0.10.6",
					"commit": "6e57342c414a72cdd721e8df5bc7967e17459647"
				},
				{
					"type": "script",
					"dest-filename": "autogen.sh",
					"commands": [
						"autoreconf -fi"
					]
				}
			]
		},
		{
			"name": "cython",
			"buildsystem": "simple",
			"build-options": {
				"build-args": [
					"--share=network"
				]
			},
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} cython"
			]
		},
		{
			"name": "PyGobject",
			"buildsystem": "simple",
			"build-options": {
				"build-args": [
					"--share=network"
				]
			},
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} PyGobject"
			]
		},
		{
			"name": "sortedcontainers",
			"buildsystem": "simple",
			"build-options": {
				"build-args": [
					"--share=network"
				]
			},
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} sortedcontainers"
			]
		},
		{
			"name": "mido",
			"buildsystem": "simple",
			"build-options": {
				"build-args": [
					"--share=network"
				]
			},
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} mido"
			],
			"cleanup": [
				"/bin"
			]
		},
		{
			"name": "python-rtmidi",
			"buildsystem": "simple",
			"build-options": {
				"build-args": [
					"--share=network"
				]
			},
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} python-rtmidi"
			]
		},
		{
			"name": "JACK-Client",
			"buildsystem": "simple",
			"build-options": {
				"build-args": [
					"--share=network"
				]
			},
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} JACK-Client"
			]
		},
		{
			"name": "falcon",
			"buildsystem": "simple",
			"build-options": {
				"build-args": [
					"--share=network"
				]
			},
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} falcon"
			]
		},
		{
			"name": "pyliblo",
			"buildsystem": "simple",
			"build-options": {
				"build-args": [
					"--share=network"
				]
			},
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} pyliblo"
			]
		},
		{
			"name": "requests",
			"buildsystem": "simple",
			"build-options": {
				"build-args": [
					"--share=network"
				]
			},
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} requests"
			]
		},
		{
			"name": "linux-show-player",
			"buildsystem": "simple",
			"build-options": {
				"build-args": [
					"--share=network"
				]
			},
			"build-commands": [
				"pip3 install --prefix=${FLATPAK_DEST} .",
				"mkdir -p /app/share/applications/",
				"cp dist/linuxshowplayer.desktop /app/share/applications/",
				"mkdir -p /app/share/mime/packages/",
				"cp dist/linuxshowplayer.xml /app/share/mime/packages/com.github.FrancescoCeruti.LinuxShowPlayer.xml",
				"mkdir -p /app/share/metainfo/",
				"cp dist/linuxshowplayer.appdata.xml /app/share/metainfo/",
				"mkdir -p /app/share/icons/hicolor/512x512/apps/",
				"cp dist/linuxshowplayer.png /app/share/icons/hicolor/512x512/apps/"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/FrancescoCeruti/linux-show-player.git",
					"branch": "master"
				}
			]
		}
	]
}
